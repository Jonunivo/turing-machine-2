<!DOCTYPE html>
<html>

    <head>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>TuringMachine</title>

        <link rel="stylesheet" href="styles/styles.css">

    </head>

    <body>
        <!-- Title -->
        <div id="titleDiv" class="centered-content">        
            <h1 id="head-title">TuringMachine Simulator</h1>
        </div>

        <!-- Cytoscape windows -->
        <div id="cytoscape"></div>
        <div id="cytoscape-tape"></div>

        <!-- Tape Arrow -->
        <div class="arrow-down"></div>

        <!-- Tape control -->
        <div id="tapeControlDiv" class="centered-content">
            <button id="move-tape-left" class="grey-button">Band nach links</button>
            <button id="move-tape-right" class="grey-button">Band nach rechts</button>
            <div id="writeOnTapeDiv">
                <input type="text" id="tape-input-field" required oninput="replaceSpace()">
                <button id="tape-input" class="grey-button">Band schreiben</button>
            </div>
        </div>

        <!-- Simulation Control -->
        <div id="simulationControlDiv" class="centered-content">
            <button id="resetSimulationButton" class="green-button"><| Reset</button>
            <button id="runSimulationButton" class="green-button">Run Simulation</button>
            <button id="stepSimulationButton" class="green-button">Schritt ></button>
            <div id="simulationSpeeddiv" class="centered-content">
                <input type="range" min="1" max="10" step=0.01 value="2" class="slider" id="simulationSpeed">
                <br>
                <label for="simulationSpeed">Simulation Speed</label>
            </div>
        </div>

        <!-- Presets & Save & Load -->
        <div id="rightWindow">

            <!-- Preset -->
            <div id="choosePreset" class="optionMenu">
                <select id="presetSelect" name="preset">
                    <option value="empty" selected>No Preset</option>
                    <option value="PresetOne">add one binary</option>
                </select>
            </div>

            <!-- Save/Load -->
            <div id="saveLoad">
                <input id="fileInput" type="file" accept=".json">
                <br>
                <button id="saveButton" class="button grey-button">TM speichern</button>
            </div>
        </div>


        <!-- User Description -->
        <div id="leftWindow">
            <h3>Bedienung:</h3>
            <div id="userGuide">
                Doppelklick erstellt Zustand 
                <br><br>
                Rechtsklick auf Zustand, <br> um ihn zu bearbeiten
                <br><br>
                Klick auf Zustand, <br> um Übergang zu erstellen
                <br><br>
                Klick auf Übergang, <br> um Übergang zu bearbeiten
            </div>
        </div>






        



        <!-- Save Modal -->
        <div id="saveModal" class="modal">
            <div id="saveModalContent" class="modal-content">
                <h2>Enter a filename for the downloaded file:</h2>
                <div>
                    <label id="saveTapeContent" for="filenameInput">filename: </label>            
                    <input type="text" id="filenameInput" placeholder="MyTuringMachine.json">

                </div>
                <div>
                    <input type="checkbox" class="basic-checkbox" id="saveTape">
                    <label id="saveTapeCheckbox" for="saveTape">also save tape?</label>
                </div>
                <br>
                <button id="saveConfirm">Save</button>
                <button id="cancelButton3">Cancel</button>
            </div>
        </div>



        <!-- Node Creation -->
        <div id="nodeModal" class="modal">
            <div id="nodeModalContent" class="modal-content">
                <h3>Node Properties</h3>
                <label for="stateName" >Node Name:</label>
                <input type="text" id="stateName" oninput="limitNameSize(8)">
                <div class="checkbox-div">
                    <input type="checkbox" id="stateStarting" class="fancy-checkbox" name="startingState" value="false" required checked>
                    <label class="checkboxLabel" for="stateStarting">Starting?</label>
                </div>
                <div class="checkbox-div">
                    <input type="checkbox" id="stateAccepting" class="fancy-checkbox" name="acceptingState" value="true" required>
                    <label class="checkboxLabel" for="stateAccepting">Accepting?</label>
                </div>
                <div class="checkbox-div">
                    <input type="checkbox" id="stateRejecting" class="fancy-checkbox" name="rejectingState" value="true" required>
                    <label class="checkboxLabel" for="stateRejecting">Rejecting?</label>
                </div>
                
                <br>
                <div class="submit-button-div">
                    <button id="nodeButton" type="button">Create Node</button>
                </div>
                <div id="deleteNodeDiv">
                    <!-- cytoscape.js will insert a delete button here -->
                </div>
                <div class="cancel-button-div">
                    <button id="cancelButton" type="button">cancel</button>
                </div>
            </div>
        </div>
        <!-- Edge Creation -->
        <div id="edgeModal" class="modal">
            <div id="edgeModalContent" class="modal-content">
                <h3>Edge Properties</h3>
                <div id="fromStateDiv"></div>
                <label for="toState">To State:</label>
                <select id="toState"></select>
                
                <br>
                <label for="readLabel">When reading label</label>
                <input type="text" id="readLabel"  class="modal-input" oninput="limitInputTo1Character(this)">
                <br>
                <label for="writeLabel">Write Label?</label>
                <input type="text" id="writeLabel"  class="modal-input" oninput="limitInputTo1Character(this)">
                <br>
                <div class="slider-div">
                    <label for="tapeMovement">Cursor Movement</label>
                    <input type="range" id="tapeMovement" min="-1" max="1" step="1" value="0">
                </div>
                
                
                <br>
                <div class="submit-button-div">
                    <button id="edgeButton" type="button">Create Edge</button>
                </div>
                <div id="deleteEdgeDiv">
                    <!-- cytoscape.js will insert a delete button here -->
                </div>
                <div class="cancel-button-div">
                    <button id="cancelButton2" type="button">cancel</button>
                </div>
            </div>
        </div>


        <footer>

            Note: this is a developer build, some things might not yet be working as intended
            <br>
            <a href="prototype/">Prototype</a>
        </footer>

        
        

        <!--- links to the scripts -->
        <script>
            // Disable the default context menu on the entire document (right click)
            document.addEventListener('contextmenu', function(event) {
                event.preventDefault();
            });

            //limit input to 1 character
            function limitInputTo1Character(input) {
                if (input.value.length >= 1) {
                    // If more than one character is entered, only keep the first character
                    input.value = input.value.charAt(0);
                    //replace " " with ﹍
                    if(input.value === " "){
                        input.value = "﹍"
                    }
                }
            }

            //replace " " with ﹍ in input field
            function replaceSpace(){
                let input = document.getElementById("tape-input-field").value;
                let output = input.replace(/ /g, '\uFE4D');
                document.getElementById("tape-input-field").value = output;
            }

            //limit node name size to size
            function limitNameSize(size){
                let input = document.getElementById("stateName").value;
                if(input.length > size){
                    let output = input.slice(0,size);
                    document.getElementById("stateName").value = output;
                }
            }

        
        </script>
        
        <!-- modules -->
        <script type="module" src="./modules/State.js" ></script>
        <script type="module" src="./modules/TuringMachine.js" ></script>


        <script type="module" src="./modules/Cytoscape.js"></script>
        <script type="module" src="./modules/CytoscapeTape.js"></script>

        <script type="module" src="./modules/UserInput.js"></script>
        <script type="module" src="./modules/UserEdit.js"></script>



        <script type="module" src="./modules/Presets.js"></script>
        <script type="module" src="./modules/Simulation.js"></script>

        <script type="module" src="./modules/SaveLoad.js"></script>


    </body>

</html>